var text=GetQueryString("search");var type=GetQueryString("type");var vg=new Vue({data:{page:0,searchText:GetQueryString("search")||"",cate:GetQueryString("cate")||"",brand:GetQueryString("brand")||"",priceMin:"",priceMax:"",sales:"",priceSore:"",shopList:[]},methods:{goods:function(c){vg.page=c;var b=this;var a=0;if(this.priceMin==""){a=0}else{a=this.priceMin}$.ajax({url:"/web_api/item/index.php?c=PCGoods&m=ProductList&pagesize=20&page="+c+"&search="+this.searchText+"&cate="+this.cate+"&brand="+this.brand+"&price_range="+a+","+this.priceMax+"&sales="+this.sales+"&price="+this.priceSore,type:"get",async:true,dataType:"json",beforeSend:function(){layer.load(1,{shade:0.3});$(window).unbind("scroll")},success:function(f){if(f.status==1&&f.data.length!=0){layer.closeAll();var g=f.data;if(c==0){$("#goodsL").html("")}var e="";$.each(g,function(h){var k={moId:0,moZid:0};if(g[h].promotion.length!=0){k.moId=g[h].promotion[0].id;if(g[h].promotion[0].gift.length!=0){k.moZid="";$.each(g[h].promotion[0].gift,function(i){k.moZid+=g[h].promotion[0].gift[i].id+","});k.moZid=(k.moZid.substring(k.moZid.length-1)==",")?k.moZid.substring(0,k.moZid.length-1):k.moZid}}var d='<div title="加入收藏" onclick="goCollect(this,'+g[h].goods_id+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px"><i class="fa fa-star" aria-hidden="true"></i></div>';if(g[h].collect==1){d='<div title="加入收藏" class="active" onclick="goCollect(this,'+g[h].goods_id+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px;color: red;"><i class="fa fa-star" aria-hidden="true"></i></div>'}var l=g[h].shop_name;if(l=="健行快养旗舰店"){l="同致相伴旗舰店"}var j='<div class="triangle" style="position: absolute;top: 0;left: 0;">'+g[h].dealer+"</div>";if(g[h].dealer!="自营"){j=""}e+='            <div class="hoverGoods pr" style="background: #fff;width: 233px;height: 352px;border: 1px solid #ddd;float: left;margin: 6px;">\n                <div onclick="vm.dorShopDetail('+g[h].product_id+',\'\')">\n                    <div style="width: 233px;height: 215px;padding: 24px;overflow: hidden;padding-bottom: 0;display: table-cell;vertical-align: middle;text-align: center;">\n                        <img style="max-height: 185px;max-width: 185px;margin: 0 auto;" src="'+g[h].pic+'" alt="" />\n                    </div>\n                    <div style="padding: 0 6px;">\n                        <span style="color: #e62129;font-size: 1.5em;"><span style="font-size: .8em">￥</span>'+g[h].seal_price+'</span>\n                    </div>\n                    <div>\n                        <div style="padding: 0 8px;color: #000;height: 40px;overflow: hidden;font-size: 1em" title="'+g[h].product_title+'">'+g[h].product_title+'</div>\n                    </div>\n                    <div style="color: #949494;padding: 0 8px;margin-top: 5px">'+l+'</div>                </div>\n                <div style="border-top: 1px solid #ddd;margin-top: 6px"><div style="display: inline-block;width: 165px;height: 33px;text-align: center;line-height: 33px">该款月销 <span style="color: #FF4502">'+g[h].sales+"</span> 件</div>"+d+'<div title="加入购物车" onclick="vm.goCart(this,\'list\','+g[h].product_id+","+g[h].shop_id+",0,"+k.moId+","+k.moZid+","+g[h].minimum_order_quantity+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px"><i class="fa fa-shopping-cart" aria-hidden="true"></i></div>               </div>'+j+"            </div>"});$("#goodsL").append(e);$(window).bind("scroll",function(){var h=$(this).scrollTop();var d=$(document).height();var i=$(this).height();if(h+i==d){b.goods(++b.page);$(window).unbind("scroll")}})}else{$(window).unbind("scroll");layer.closeAll();layer.msg("没有更多商品了",{time:2000,icon:5})}}})}}});new Vue({el:"#index",data:{show:false,typeShow:true,btnPrice:false},mounted:function(){var a=this;document.addEventListener("click",function(b){if(b.target.className!="rangePri"){a.btnPrice=false}})},methods:{moreDor:function(c,g,h){var d=this;var a=c.currentTarget;var b=$(a).siblings().find(".btn-default.active").attr("value");if($(a).find("span").html()=="查看更多"){$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserGoodsLists&pagesize=100&shop_id="+h+"&sort="+b,type:"get",async:false,dataType:"json",success:function(e){$(a).find("span").html("收起");vg.shopList[g].child_data=e.data}})}else{var f=[];$(a).find("span").html("查看更多");$.each(vg.shopList[g].child_data,function(e){if(e==5){return false}f.push(vg.shopList[g].child_data[e])});vg.shopList[g].child_data=f}},priceVal:function(a){this.btnPrice=true},priceSure:function(){this.btnPrice=false;vg.goods(0)},priceCancel:function(){this.btnPrice=false},priceTB:function(b){var a=b.currentTarget;if($(a).hasClass("price")){$(a).removeClass().addClass("price1 pri").siblings().removeClass("active");vg.priceSore="asc"}else{if($(a).hasClass("price1")){$(a).removeClass().addClass("price2 pri");vg.priceSore="desc"}else{$(a).removeClass().addClass("price pri");vg.priceSore=""}}vg.goods(0)},search:function(c,b){var a=c.currentTarget;if(!$(a).hasClass("active")){$(a).addClass("active").siblings().removeClass("active");this.typeShow=!this.typeShow;if(b==2){vm.Searchtype=1;$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserShopLists&search="+vg.searchText,type:"get",async:false,dataType:"json",success:function(d){vg.shopList=d.data}});$(window).unbind("scroll")}else{vm.Searchtype=0;vg.goods(0)}}},sort:function(b,c){var a=b.currentTarget;if(!$(a).hasClass("active")){$(a).addClass("active").siblings().removeClass("active").siblings(".pri").removeClass().addClass("price pri");vg.priceSore="";if(c=="sales"){vg.sales="desc"}else{vg.sales=""}vg.goods(0)}},dorHead:function(f,c,a,g){var b=f.currentTarget;var d=this;if(!$(b).hasClass("active")){$(b).addClass("active").siblings().removeClass("active");$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserGoodsLists&pagesize=100&shop_id="+g+"&sort="+c,type:"get",async:false,dataType:"json",success:function(h){vg.shopList[a].child_data=h.data;if($(b).parent().siblings().find("span").html()=="查看更多"){var e=[];$.each(vg.shopList[a].child_data,function(j){if(j==5){return false}e.push(vg.shopList[a].child_data[j])});vg.shopList[a].child_data=e}}})}}}});if(type=="1"){$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserShopLists&search="+vg.searchText,type:"get",async:false,dataType:"json",success:function(a){vg.shopList=a.data}})}else{vg.goods(vg.page)};