var text=GetQueryString("search");var type=GetQueryString("type");var vg=new Vue({data:{page:0,searchText:GetQueryString("search")||"",cate:GetQueryString("cate")||"",brand:GetQueryString("brand")||"",priceMin:"",priceMax:"",sales:"",priceSore:"",shopList:[]},methods:{goods:function(f){vg.page=f;var d=this;var e=0;if(this.priceMin==""){e=0}else{e=this.priceMin}$.ajax({url:"/web_api/item/index.php?c=PCGoods&m=ProductList&pagesize=20&page="+f+"&search="+this.searchText+"&cate="+this.cate+"&brand="+this.brand+"&price_range="+e+","+this.priceMax+"&sales="+this.sales+"&price="+this.priceSore,type:"get",async:true,dataType:"json",beforeSend:function(){layer.load(1,{shade:0.3});$(window).unbind("scroll")},success:function(b){if(b.status==1&&b.data.length!=0){layer.closeAll();var a=b.data;if(f==0){$("#goodsL").html("")}var c="";$.each(a,function(n){var i={moId:0,moZid:0};if(a[n].promotion.length!=0){i.moId=a[n].promotion[0].id;if(a[n].promotion[0].gift.length!=0){i.moZid="";$.each(a[n].promotion[0].gift,function(h){i.moZid+=a[n].promotion[0].gift[h].id+","});i.moZid=(i.moZid.substring(i.moZid.length-1)==",")?i.moZid.substring(0,i.moZid.length-1):i.moZid}}var o='<div title="加入收藏" onclick="goCollect(this,'+a[n].goods_id+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px"><i class="fa fa-star" aria-hidden="true"></i></div>';if(a[n].collect==1){o='<div title="加入收藏" class="active" onclick="goCollect(this,'+a[n].goods_id+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px;color: red;"><i class="fa fa-star" aria-hidden="true"></i></div>'}var g=a[n].shop_name;if(g=="健行快养旗舰店"){g="同致相伴旗舰店"}var m='<div class="triangle" style="position: absolute;top: 0;left: 0;">'+a[n].dealer+"</div>";if(a[n].dealer!="自营"){m=""}c+='            <div class="hoverGoods pr" style="background: #fff;width: 233px;height: 352px;border: 1px solid #ddd;float: left;margin: 6px;">\n                <div onclick="vm.dorShopDetail('+a[n].product_id+',\'\')">\n                    <div style="width: 233px;height: 215px;padding: 24px;overflow: hidden;padding-bottom: 0;display: table-cell;vertical-align: middle;text-align: center;">\n                        <img style="max-height: 185px;max-width: 185px;margin: 0 auto;" src="'+a[n].pic+'" alt="" />\n                    </div>\n                    <div style="padding: 0 6px;">\n                        <span style="color: #e62129;font-size: 1.5em;"><span style="font-size: .8em">￥</span>'+a[n].seal_price+'</span>\n                    </div>\n                    <div>\n                        <div style="padding: 0 8px;color: #000;height: 40px;overflow: hidden;font-size: 1em" title="'+a[n].product_title+'">'+a[n].product_title+'</div>\n                    </div>\n                    <div style="color: #949494;padding: 0 8px;margin-top: 5px">'+g+'</div>                </div>\n                <div style="border-top: 1px solid #ddd;margin-top: 6px"><div style="display: inline-block;width: 165px;height: 33px;text-align: center;line-height: 33px">该款月销 <span style="color: #FF4502">'+a[n].sales+"</span> 件</div>"+o+'<div title="加入购物车" onclick="vm.goCart(this,\'list\','+a[n].product_id+","+a[n].shop_id+",0,"+i.moId+","+i.moZid+","+a[n].minimum_order_quantity+')" style="display: inline-block;width: 33px;height: 33px;text-align: center;border-left: 1px solid #ddd;line-height: 33px"><i class="fa fa-shopping-cart" aria-hidden="true"></i></div>               </div>'+m+"            </div>"});$("#goodsL").append(c);$(window).bind("scroll",function(){var j=$(this).scrollTop();var k=$(document).height();var g=$(this).height();if(j+g==k){d.goods(++d.page);$(window).unbind("scroll")}})}else{$(window).unbind("scroll");layer.closeAll();layer.msg("没有更多商品了",{time:2000,icon:5})}}})}}});new Vue({el:"#index",data:{show:false,typeShow:true,btnPrice:false},mounted:function(){var b=this;document.addEventListener("click",function(a){if(a.target.className!="rangePri"){b.btnPrice=false}})},methods:{moreDor:function(n,k,j){var m=this;var i=n.currentTarget;var e=$(i).siblings().find(".btn-default.active").attr("value");if($(i).find("span").html()=="查看更多"){$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserGoodsLists&pagesize=100&shop_id="+j+"&sort="+e,type:"get",async:false,dataType:"json",success:function(a){$(i).find("span").html("收起");vg.shopList[k].child_data=a.data}})}else{var l=[];$(i).find("span").html("查看更多");$.each(vg.shopList[k].child_data,function(a){if(a==5){return false}l.push(vg.shopList[k].child_data[a])});vg.shopList[k].child_data=l}},priceVal:function(b){this.btnPrice=true},priceSure:function(){this.btnPrice=false;vg.goods(0)},priceCancel:function(){this.btnPrice=false},priceTB:function(c){var d=c.currentTarget;if($(d).hasClass("price")){$(d).removeClass().addClass("price1 pri").siblings().removeClass("active");vg.priceSore="asc"}else{if($(d).hasClass("price1")){$(d).removeClass().addClass("price2 pri");vg.priceSore="desc"}else{$(d).removeClass().addClass("price pri");vg.priceSore=""}}vg.goods(0)},search:function(f,d){var e=f.currentTarget;if(!$(e).hasClass("active")){$(e).addClass("active").siblings().removeClass("active");this.typeShow=!this.typeShow;if(d==2){vm.Searchtype=1;$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserShopLists&search="+vg.searchText,type:"get",async:false,dataType:"json",success:function(a){vg.shopList=a.data}});$(window).unbind("scroll")}else{vm.Searchtype=0;vg.goods(0)}}},sort:function(d,f){var e=d.currentTarget;if(!$(e).hasClass("active")){$(e).addClass("active").siblings().removeClass("active").siblings(".pri").removeClass().addClass("price pri");vg.priceSore="";if(f=="sales"){vg.sales="desc"}else{vg.sales=""}vg.goods(0)}},dorHead:function(j,l,h,i){var e=j.currentTarget;var k=this;if(!$(e).hasClass("active")){$(e).addClass("active").siblings().removeClass("active");$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserGoodsLists&pagesize=100&shop_id="+i+"&sort="+l,type:"get",async:false,dataType:"json",success:function(a){vg.shopList[h].child_data=a.data;if($(e).parent().siblings().find("span").html()=="查看更多"){var b=[];$.each(vg.shopList[h].child_data,function(c){if(c==5){return false}b.push(vg.shopList[h].child_data[c])});vg.shopList[h].child_data=b}}})}}}});if(type=="1"){$.ajax({url:"/web_api/item/index.php?c=PCHome&m=UserShopLists&search="+vg.searchText,type:"get",async:false,dataType:"json",success:function(b){vg.shopList=b.data}})}else{vg.goods(vg.page)};